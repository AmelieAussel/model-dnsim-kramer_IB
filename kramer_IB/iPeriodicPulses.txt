%%
% Poisson mechanism based on Jason's email implementation. For some
% reason this produces huge PSPs

% Pulse train properties
PPstim = -.1;
PPfreq = 40; % in Hz
PPwidth = 2; % in ms

% Time series properties
T=4000; 	    % ms, max simulation duration
dt=0.01;        % ms, time step duration
PPonset = 0;    % ms, onset time
PPoffset = Inf;   % ms, offset time

% Aperiodic pulse specification
ap_pulse_num = 11;        % The pulse number that should be delayed. 0 for no aperiodicity.
ap_pulse_delay = 12.5;  % ms, the amount the spike should be delayed. 0 for no aperiodicity.

s2=getAperiodicPulse(PPfreq,PPwidth,T,dt,PPonset,PPoffset,ap_pulse_num,ap_pulse_delay,Npop);

Iext(X)=PPstim*s2(k,:)
current => -Iext(X)

